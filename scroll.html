<html>

<head>
  <script type="text/javascript">
    window.addEventListener('keydown', keydown, false);
    window.addEventListener('keyup', keyup, false);

    let L, R, U, D, S;
    function keydown(k) {
      if (k.keyCode == 32) {//space
        S = true;
      } else if (k.keyCode == 83) {
        L = true;
      } else if (k.keyCode == 70) {
        R = true;
      } else if (k.keyCode == 69) {
        U = true;
      } else if (k.keyCode == 68) {
        D = true;
      } else {
        console.log(k.keyCode);
      }
    }
    function keyup(k) {
      if (k.keyCode == 32) {//space
        S = false;
      } else if (k.keyCode == 83) {
        L = false;
      } else if (k.keyCode == 70) {
        R = false;
      } else if (k.keyCode == 69) {
        U = false;
      } else if (k.keyCode == 68) {
        D = false;
      }
    }

    let bg_img = new Image();
    bg_img.src = "tiles_packed.png";
    let char_img = new Image();
    char_img.src = "characterss_packed.png";

    scr = {
      x: 0, y: 0,
      vx: 0, vy: 0
    };

    let bg = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 3, 3, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 3, 3, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 3, 3, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 2, 3, 3, 3, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0, 0, 0, 0, 2, 3, 3, 3, 3, 3, 4, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 127, 0, 0, 0, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 23, 23, 23, 23, 23, 23, 23, 23, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 122, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 122, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 0, 0, 0, 0, 127, 0, 0, 0, 0, 122, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 0, 0, 0, 22, 23, 23, 23, 23, 23, 23, 23,
      0, 0, 0, 0, 89, 0, 0, 0, 127, 0, 0, 128, 0, 122, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 0, 0, 22, 23, 23, 23, 23, 23, 23, 123, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 0, 0, 0, 122, 123, 123, 123, 123, 123, 123, 123,
      23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 127, 0, 122, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 124, 0, 0, 0, 0, 0, 122, 123, 123, 123, 123, 123, 123, 123,
      123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 23, 23, 23, 23, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 23, 23, 23, 23, 23, 123, 123, 123, 123, 123, 123, 123, 123,
      123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123,
      123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123, 123]
      ;
    let bgh = 20;
    let bgw = 60;

    let block = [
    ];


    function update() {
      if (L) scr.vx -= 0.02;
      if (R) scr.vx += 0.02;
      if (U) scr.vy -= 0.02;
      if (D) scr.vy += 0.02;
      scr.x += scr.vx;
      scr.y += scr.vy;
      scr.vx *= 0.95;
      scr.vy *= 0.95;
    }

    function render() {
      let scale = 36;
      let width = 1600;
      let height = 900;
      let tile = 18;
      var c = document.getElementById("canvas");
      var ctx = c.getContext("2d");
      ctx.fillStyle = "#000";
      ctx.fillRect(0, 0, 1600, 900);

      for (var y = -scale; y < height+scale; y += scale) {
        for (var x = -scale; x < width+scale; x += scale) {
          let src = bg[(((scr.y+y / scale) >>> 0) % bgh) * bgw + (((scr.x+x / scale) >>> 0) % bgw)];
          if (src) {
            src -= 1;
            ctx.drawImage(bg_img,
              (src % 20) * tile, (src / 20 >> 0) * tile, tile, tile,
              x - (scr.x-(scr.x>>0))*scale , y - (scr.y-(scr.y>>0))*scale, scale, scale);
          }
        }
      }
    }

    setInterval(() => {
      update();
      render();
    }, 17);
  </script>
</head>

<body>
  <canvas id="canvas" width="1600" height="900" style="background:rgb(0, 0, 0)"></canvas>
</body>

</html>